{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nimport * as React from 'react';\nimport * as PropTypes from 'prop-types';\nimport { ColorPaletteService } from './utils/color-palette.service';\nimport { classNames, Keys, dispatchEvent, guid, getTabIndex } from '@progress/kendo-react-common';\nimport { PALETTEPRESETS } from './models/palette-presets';\nimport { isPresent } from './utils/misc';\nimport { parseColor } from './utils/color-parser';\n/**\n * @hidden\n */\n\nexport var DEFAULT_TILE_SIZE = 24;\n/**\n * @hidden\n */\n\nexport var DEFAULT_COLUMNS_COUNT = 10;\n/**\n * @hidden\n */\n\nexport var DEFAULT_PRESET = 'office';\n/**\n * Represents the [KendoReact ColorPalette component]({% slug overview_colorpalette %}).\n *\n * @example\n * ```jsx\n * class App extends React.Component {\n *     render() {\n *         return <ColorPalette palette='basic' />;\n *     }\n * }\n * ReactDOM.render(<App />, document.querySelector('my-app'));\n * ```\n */\n\nvar ColorPalette =\n/** @class */\nfunction (_super) {\n  __extends(ColorPalette, _super);\n\n  function ColorPalette(props) {\n    var _this = _super.call(this, props) || this;\n    /**\n     * @hidden\n     */\n\n\n    _this.wrapper = null;\n    _this.guid = guid();\n\n    _this.onKeyDown = function (event) {\n      switch (event.keyCode) {\n        case Keys.down:\n          _this.handleCellNavigation(0, 1);\n\n          break;\n\n        case Keys.up:\n          _this.handleCellNavigation(0, -1);\n\n          break;\n\n        case Keys.right:\n          _this.handleCellNavigation(1, 0);\n\n          break;\n\n        case Keys.left:\n          _this.handleCellNavigation(-1, 0);\n\n          break;\n\n        case Keys.enter:\n          _this.handleEnter(event);\n\n          break;\n\n        default:\n          return;\n      }\n\n      event.preventDefault();\n    };\n\n    _this.onColorClick = function (color, event) {\n      if (_this.isUncontrolled) {\n        _this.setState({\n          selectedColor: color,\n          focusedColor: color\n        });\n      } else {\n        _this.setState({\n          focusedColor: color\n        });\n      }\n\n      _this.dispatchChangeEvent(color, event);\n    };\n\n    _this.onFocus = function () {\n      _this.setState({\n        focusedColor: _this.state.selectedColor || _this.paletteService.colorRows[0][0]\n      });\n    };\n\n    _this.onBlur = function () {\n      _this.setState({\n        focusedColor: undefined\n      });\n    }; // The empty string for the `value` prop means no selection but controlled mode.\n\n\n    _this.state = {\n      selectedColor: _this.props.value !== undefined ? _this.props.value : _this.props.defaultValue,\n      isFirstRender: true\n    };\n    return _this;\n  }\n  /**\n   * @hidden\n   */\n\n\n  ColorPalette.prototype.focus = function () {\n    if (this.wrapper) {\n      this.wrapper.focus();\n    }\n  };\n  /**\n   * @hidden\n   */\n\n\n  ColorPalette.prototype.render = function () {\n    var _this = this;\n\n    var paletteInfo = this.getPaletteInfo();\n    var svc = this.paletteService = new ColorPaletteService();\n    svc.setColorMatrix(paletteInfo.colors, paletteInfo.columns);\n    var selectedCellCoords = svc.getCellCoordsFor(this.state.selectedColor);\n    var focusedCellCoords = svc.getCellCoordsFor(this.state.focusedColor);\n    var className = classNames('k-widget k-colorpalette', {\n      'k-state-disabled': this.props.disabled\n    });\n\n    if (paletteInfo.colors.length) {\n      return React.createElement(\"div\", {\n        className: className,\n        onFocus: this.onFocus,\n        onBlur: this.onBlur,\n        onKeyDown: this.onKeyDown,\n        \"aria-disabled\": this.props.disabled ? 'true' : undefined,\n        \"aria-activedescendant\": selectedCellCoords && this.createCellId(selectedCellCoords),\n        tabIndex: getTabIndex(this.props.tabIndex, this.props.disabled),\n        ref: function (el) {\n          return _this.wrapper = el;\n        }\n      }, React.createElement(\"div\", {\n        role: \"grid\"\n      }, React.createElement(\"table\", {\n        className: \"k-palette k-reset\",\n        role: \"presentation\"\n      }, React.createElement(\"tbody\", null, this.renderRows(svc.colorRows, selectedCellCoords, focusedCellCoords)))));\n    } else {\n      // In this way, the code prevents an eventual focus of the component when no cells are available.\n      // This is needed because upon focus the first cell gets focused.\n      return '';\n    }\n  };\n  /**\n   * @hidden\n   */\n\n\n  ColorPalette.getDerivedStateFromProps = function (props, state) {\n    if (!state.isFirstRender && props.value !== undefined) {\n      // The component is in controlled mode.\n      if (props.value === '' && state.selectedColor !== undefined) {\n        // The selection has to be removed.\n        return {\n          selectedColor: undefined\n        };\n      } else if (props.value !== '' && props.value !== state.selectedColor) {\n        return {\n          selectedColor: props.value\n        };\n      }\n    } else if (state.isFirstRender) {\n      return {\n        isFirstRender: false\n      };\n    }\n\n    return null;\n  };\n\n  ColorPalette.prototype.handleCellNavigation = function (horizontalStep, verticalStep) {\n    if (this.focusedColorCooridanates) {\n      var newCoords = this.paletteService.getNextCell(this.focusedColorCooridanates, horizontalStep, verticalStep);\n      this.setState({\n        focusedColor: this.paletteService.getColorAt(newCoords)\n      });\n    } else {\n      this.setState({\n        focusedColor: this.paletteService.colorRows[0][0]\n      });\n    }\n  };\n\n  ColorPalette.prototype.handleEnter = function (event) {\n    if (this.isUncontrolled) {\n      this.setState({\n        selectedColor: this.state.focusedColor\n      });\n    }\n\n    this.dispatchChangeEvent(this.state.focusedColor, event);\n  };\n\n  ColorPalette.prototype.dispatchChangeEvent = function (value, event) {\n    dispatchEvent(this.props.onChange, event, this, {\n      value: value,\n      rgbaValue: parseColor(value, 'rgba')\n    });\n  };\n\n  Object.defineProperty(ColorPalette.prototype, \"focusedColorCooridanates\", {\n    get: function () {\n      return this.state.focusedColor ? this.paletteService.getCellCoordsFor(this.state.focusedColor) : undefined;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(ColorPalette.prototype, \"isUncontrolled\", {\n    get: function () {\n      return this.props.value === undefined;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  ColorPalette.prototype.getPaletteInfo = function () {\n    if (typeof this.props.palette === 'string') {\n      var preset = PALETTEPRESETS[this.props.palette];\n\n      if (isPresent(preset)) {\n        return {\n          colors: preset.colors,\n          columns: this.props.columns || preset.columns || DEFAULT_COLUMNS_COUNT\n        };\n      } else {\n        return {\n          colors: [],\n          columns: 0\n        };\n      }\n    } else {\n      return {\n        colors: this.props.palette || [],\n        columns: this.props.columns || DEFAULT_COLUMNS_COUNT\n      };\n    }\n  };\n\n  ColorPalette.prototype.renderRows = function (rows, selectedCellCoords, focusedCellCoords) {\n    var _this = this;\n\n    return rows.map(function (row, i) {\n      return React.createElement(\"tr\", {\n        role: \"row\",\n        key: i\n      }, _this.renderColumns(row, i, selectedCellCoords, focusedCellCoords));\n    });\n  };\n\n  ColorPalette.prototype.renderColumns = function (columns, rowIndex, selectedCellCoords, focusedCellCoords) {\n    var _this = this;\n\n    var rowIsSelected = selectedCellCoords !== undefined && selectedCellCoords.row === rowIndex;\n    var selectedColumn = selectedCellCoords && selectedCellCoords.col;\n    var rowIsFocused = focusedCellCoords !== undefined && focusedCellCoords.row === rowIndex;\n    var focusedColumn = focusedCellCoords && focusedCellCoords.col;\n    var tileSize = typeof this.props.tileSize !== 'number' ? this.props.tileSize : {\n      width: this.props.tileSize,\n      height: this.props.tileSize\n    };\n    var width = tileSize.width + 'px';\n    var height = tileSize.height + 'px';\n    return columns.map(function (color, i) {\n      var isSelected = rowIsSelected && selectedColumn === i;\n      var className = classNames('k-item', {\n        'k-state-selected': isSelected,\n        'k-state-focused': rowIsFocused && focusedColumn === i\n      });\n      return React.createElement(\"td\", {\n        className: className,\n        \"aria-label\": color,\n        \"aria-selected\": isSelected ? true : _this.props.disabled ? undefined : false,\n        style: {\n          backgroundColor: color,\n          width: width,\n          height: height,\n          minWidth: width\n        },\n        onClick: function (event) {\n          return _this.onColorClick(color, event);\n        },\n        id: _this.createCellId({\n          row: rowIndex,\n          col: i\n        }),\n        key: i\n      });\n    });\n  };\n\n  ColorPalette.prototype.createCellId = function (cellCoords) {\n    return this.guid + \"_\" + cellCoords.row + \"_\" + cellCoords.col;\n  };\n  /**\n   * @hidden\n   */\n\n\n  ColorPalette.propTypes = {\n    palette: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.string), PropTypes.string]),\n    columns: PropTypes.number,\n    tileSize: PropTypes.any,\n    defaultValue: PropTypes.string,\n    value: PropTypes.string,\n    disabled: PropTypes.bool,\n    tabIndex: PropTypes.number,\n    onChange: PropTypes.func\n  };\n  /**\n   * @hidden\n   */\n\n  ColorPalette.defaultProps = {\n    palette: DEFAULT_PRESET,\n    tileSize: DEFAULT_TILE_SIZE\n  };\n  return ColorPalette;\n}(React.Component);\n\nexport { ColorPalette };","map":null,"metadata":{},"sourceType":"module"}